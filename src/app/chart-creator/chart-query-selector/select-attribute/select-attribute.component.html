<div class="simple segment">
  <div class="ui fluid selection dropdown link item" suiDropdown>

    <div *ngIf="selectedNode !== null; else nullSelectedField">
      <div class="ui breadcrumb" #selectedFieldLength *ngFor="let field of selectedNode.name.split('.'); let i = index">
        <div *ngIf="i !== selectedNode.name.split('.').length - 1 ; else activeField">
          <span class="section">{{field | titlecase}}</span>
          <div class="divider"> > </div>
        </div>
        <ng-template #activeField>
          <span class="active section">{{field | titlecase}}</span>
        </ng-template>
      </div>
    </div>
    <ng-template #nullSelectedField>
      <div class="default text">Select Entity Field</div>
    </ng-template>

    <i class="dropdown icon"></i>
    
    <div class="menu" suiDropdownMenu>
    <div class="ui item">
    <div class="mat-app-background basic-container">

      <mat-tree [dataSource]="nestedEntityDataSource" [treeControl]="nestedEntityTreeControl" class="data-tree" >

        <mat-nested-tree-node *matTreeNodeDef="let node; when: hasNestedChild">
          <li class="mat-tree-node" id="data-tree-entity-field">
            <button type="button" id="data-tree-button" class="ui compact icon button" 
                mat-icon-button matTreeNodeToggle 
                [attr.aria-label]="'toggle ' + node.name"
                (click)="onExpanded(node)">
              <mat-icon class="mat-icon-rtl-mirror">
                {{nestedEntityTreeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
              </mat-icon>
            </button>
            {{node.name | titlecase}}
          </li>

          <ul [class.data-tree-invisible]="!nestedEntityTreeControl.isExpanded(node)">
            <li *ngFor="let field of node.fields; trackBy:trackByFieldName">
              <div class="mat-tree-node" >
                <span (click)="nodeSelected(field)" style="cursor: pointer;">{{field.name | titlecase}}</span>
              </div>
            </li>

            <ng-container matTreeNodeOutlet></ng-container>
          </ul>

        </mat-nested-tree-node>
      </mat-tree>

    </div>
    </div>
    </div>
  </div>
</div>